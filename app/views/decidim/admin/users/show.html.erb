<% @user = Decidim::User.find_by_id(params[:id]) %>

<div class="secondary-nav secondary-nav--subnav">
  <ul>
    <% if allowed_to?(:enter, :space_area, space_name: :user) %>
      <li <% if is_active_link?(decidim_admin_participatory_processes.participatory_processes_path) %> class="is-active" <% end %>>
        <%= aria_selected_link_to I18n.t("menu.participatory_processes", scope: "decidim.admin"),
        '' %>
      </li>
    <% end %>
  </ul>
</div>

<div class="card">
  <div class="card-divider">
    <h2 class="card-title">
      test
    </h2>
    <h2 class="card-title">
      <%= @user.name + '(' + @user.email + ')' %>
    </h2>
  </div>
  <div class="card-section">
    <div class="table-scroll">
      <table class="table-list">
        <thead>
          <tr>
            <th class="table-list__actions"><%= t("models.user.fields.title", scope: "decidim.admin") %></th>
            <th class="table-list__actions"><%= t("models.user.fields.type", scope: "decidim.admin") %></th>
            <th class="table-list__actions"><%= t("models.user.fields.department", scope: "decidim.admin") %></th>
            <th class="table-list__actions"><%= t("models.user.fields.created_at", scope: "decidim.admin") %></th>
            <th class="table-list__actions"><%= t("models.user.fields.private", scope: "decidim.admin") %></th>
            <th class="table-list__actions"><%= t("models.user.fields.published", scope: "decidim.admin") %></th>
          </tr>
        </thead>
        <tbody>
          <% @user.participatory_processes.each do |process| %>
            <tr>
              <td><%= translated_attribute(process.title) %></td>
              <td>
                <% if process.participatory_process_group %>
                  <%= translated_attribute(process.participatory_process_group&.name) %>
                <% else %>
                  <%= t("models.user.fields.process_type", scope: "decidim.admin") %>
                <% end %>
              </td>
              <td><%= translated_attribute(process.area.name) %></td>
              <td><%= l process.created_at, format: :short %></td><td class="table-list__state">
                <% if process.private_space? %>
                  <strong class="text-alert"><%= t("participatory_processes.index.private", scope: "decidim.admin") %></strong>
                <% else %>
                  <strong class="text-success"><%= t("participatory_processes.index.public", scope: "decidim.admin") %></strong>
                <% end %>
              </td>
              <td class="table-list__state">
                <% if process.published? %>
                  <strong class="text-success"><%= t("participatory_processes.index.published", scope: "decidim.admin") %></strong>
                <% else %>
                  <strong class="text-alert"><%= t("participatory_processes.index.not_published", scope: "decidim.admin") %></strong>
                <% end %>
              </td>
            </tr>
          <% end %>
          <% @user.assemblies.each do |assembly| %>
            <tr>
              <td><%= translated_attribute(assembly.title) %></td>
              <td><%= t("models.user.fields.assembly_type", scope: "decidim.admin") %></td>
              <td><%= translated_attribute(assembly.area&.name) %></td>
              <td><%= l assembly.created_at, format: :short %></td><td class="table-list__state">
                <% if assembly.private_space? %>
                  <strong class="text-alert"><%= t("models.assembly.fields.private", scope: "decidim.admin") %></strong>
                <% else %>
                  <strong class="text-success"><%= t("models.assembly.fields.public", scope: "decidim.admin") %></strong>
                <% end %>
              </td>
              <td class="table-list__state">
                <% if assembly.published? %>
                  <strong class="text-success"><%= t("models.assembly.fields.published", scope: "decidim.admin") %></strong>
                <% else %>
                  <strong class="text-alert"><%= t("models.assembly.fields.not_published", scope: "decidim.admin") %></strong>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>
